{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "fwdslsh.dev/rabit/schemas/0.3.0/burrow",
  "title": "Rabit Burrow",
  "description": "JSON Schema for .burrow.json manifest files per Rabit v0.3.0 specification",
  "type": "object",
  "required": ["specVersion", "kind", "entries"],
  "additionalProperties": false,
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema URI for validation"
    },
    "specVersion": {
      "type": "string",
      "description": "Specification version identifier",
      "const": "fwdslsh.dev/rabit/schemas/0.3.0/burrow"
    },
    "kind": {
      "type": "string",
      "description": "Document type",
      "const": "burrow"
    },
    "title": {
      "type": "string",
      "description": "Human-readable title"
    },
    "description": {
      "type": "string",
      "description": "Brief description of the burrow"
    },
    "updated": {
      "type": "string",
      "format": "date-time",
      "description": "RFC 3339 timestamp of last update"
    },
    "baseUri": {
      "type": "string",
      "format": "uri-reference",
      "description": "Base URI for resolving relative paths"
    },
    "repo": {
      "$ref": "#/$defs/repoMetadata"
    },
    "agents": {
      "$ref": "#/$defs/agentInstructions"
    },
    "entries": {
      "type": "array",
      "description": "Array of entry objects",
      "items": {
        "$ref": "#/$defs/entry"
      }
    },
    "metadata": {
      "type": "object",
      "description": "Custom metadata for forward compatibility and extensibility",
      "additionalProperties": true
    },
    "extensions": {
      "type": "object",
      "description": "Vendor/plugin-specific data (deprecated, use metadata)",
      "additionalProperties": true
    }
  },
  "$defs": {
    "entry": {
      "type": "object",
      "description": "A menu item in the burrow",
      "required": ["id", "kind", "uri"],
      "additionalProperties": false,
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier within the burrow",
          "minLength": 1
        },
        "kind": {
          "type": "string",
          "description": "Entry type",
          "enum": ["file", "dir", "burrow", "link"]
        },
        "uri": {
          "type": "string",
          "description": "URI to fetch or enter (relative resolved to baseUri)"
        },
        "title": {
          "type": "string",
          "description": "Human-readable title"
        },
        "summary": {
          "type": "string",
          "description": "Short description for agents"
        },
        "path": {
          "type": "string",
          "description": "Relative path inside the burrow"
        },
        "mediaType": {
          "type": "string",
          "description": "MIME type (e.g., text/markdown)"
        },
        "sizeBytes": {
          "type": "integer",
          "minimum": 0,
          "description": "File size in bytes"
        },
        "modified": {
          "type": "string",
          "format": "date-time",
          "description": "RFC 3339 timestamp"
        },
        "sha256": {
          "type": "string",
          "description": "Hex digest for cache validation",
          "pattern": "^[a-f0-9]{64}$"
        },
        "tags": {
          "type": "array",
          "description": "Categorization tags",
          "items": {
            "type": "string"
          }
        },
        "priority": {
          "type": "number",
          "description": "Higher values = more prominent in menus"
        },
        "metadata": {
          "type": "object",
          "description": "Custom metadata for this entry",
          "additionalProperties": true
        }
      }
    },
    "repoMetadata": {
      "type": "object",
      "description": "Standard repository file locations",
      "additionalProperties": true,
      "properties": {
        "readme": {
          "type": "string",
          "description": "Path to README file"
        },
        "license": {
          "type": "string",
          "description": "Path to LICENSE file"
        },
        "contributing": {
          "type": "string",
          "description": "Path to CONTRIBUTING file"
        },
        "changelog": {
          "type": "string",
          "description": "Path to CHANGELOG file"
        }
      }
    },
    "agentInstructions": {
      "type": "object",
      "description": "Agent instructions for LLM-based clients",
      "additionalProperties": true,
      "properties": {
        "context": {
          "type": "string",
          "description": "Brief description for LLM context (recommended: under 500 characters)",
          "maxLength": 1000
        },
        "entryPoint": {
          "type": "string",
          "description": "Suggested starting entry id"
        },
        "hints": {
          "type": "array",
          "description": "Freeform processing hints",
          "items": {
            "type": "string"
          }
        }
      }
    }
  }
}
