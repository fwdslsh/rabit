# SSH Server Configuration for Read-Only Git Access
# This config enables clean repository URLs without /srv/git prefix

# Basic settings
Port 22
Protocol 2
AddressFamily any
ListenAddress 0.0.0.0

# Host keys (mounted from host for persistence)
HostKey /etc/ssh/host-keys/ssh_host_rsa_key
HostKey /etc/ssh/host-keys/ssh_host_ed25519_key
HostKey /etc/ssh/host-keys/ssh_host_ecdsa_key

# Authentication
PermitRootLogin no
PubkeyAuthentication yes
PasswordAuthentication no
PermitEmptyPasswords no
ChallengeResponseAuthentication no

# Only allow the git user
AllowUsers git

# Use git-shell for the git user (restricts to git commands only)
# The git-shell-commands directory provides read-only enforcement
Match User git
    X11Forwarding no
    AllowTcpForwarding no
    AllowAgentForwarding no
    PermitTTY no

# Logging
SyslogFacility AUTH
LogLevel INFO

# Security
StrictModes yes
MaxAuthTries 3
MaxSessions 10

# Performance
UseDNS no
